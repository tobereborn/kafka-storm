INFO main kafka.utils.VerifiableProperties - Property log.dir is overridden to D:\dev\git\kafka-storm\target\cluster\broker_9003
INFO main kafka.utils.VerifiableProperties - Property port is overridden to 9003
INFO main kafka.utils.VerifiableProperties - Property zookeeper.connect is overridden to localhost:2181
INFO main kafka.server.KafkaServer - [Kafka Server 9003], starting
INFO main kafka.server.KafkaServer - [Kafka Server 9003], Connecting to zookeeper on localhost:2181
INFO main org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:2181 sessionTimeout=6000 watcher=org.I0Itec.zkclient.ZkClient@c03cf28
INFO ZkClient-EventThread-67-localhost:2181 org.I0Itec.zkclient.ZkEventThread - Starting ZkClient event thread.
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.ReplicaStateMachine$BrokerChangeListener - [BrokerChangeListener on Controller 9001]: Newly added brokers: 9001, deleted brokers: , all live brokers: 9001
INFO main-SendThread(127.0.0.1:2181) org.apache.zookeeper.ClientCnxn - Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
INFO main-SendThread(127.0.0.1:2181) org.apache.zookeeper.ClientCnxn - Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
INFO NIOServerCxn.Factory:localhost/127.0.0.1:2181 org.apache.zookeeper.server.NIOServerCnxnFactory - Accepted socket connection from /127.0.0.1:3391
INFO NIOServerCxn.Factory:localhost/127.0.0.1:2181 org.apache.zookeeper.server.ZooKeeperServer - Client attempting to establish new session at /127.0.0.1:3391
INFO SyncThread:0 org.apache.zookeeper.server.ZooKeeperServer - Established session 0x154a916065c0002 with negotiated timeout 6000 for client /127.0.0.1:3391
INFO main-SendThread(127.0.0.1:2181) org.apache.zookeeper.ClientCnxn - Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x154a916065c0002, negotiated timeout = 6000
INFO main-EventThread org.I0Itec.zkclient.ZkClient - zookeeper state changed (SyncConnected)
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.RequestSendThread - [Controller-9001-to-broker-9001-send-thread], Controller 9001 connected to id:9001,host:localhost,port:9001 for sending state change requests
INFO Controller-9001-to-broker-9001-send-thread kafka.controller.RequestSendThread - [Controller-9001-to-broker-9001-send-thread], Starting 
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.KafkaController - [Controller 9001]: New broker startup callback for 9001
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.ReplicaStateMachine$BrokerChangeListener - [BrokerChangeListener on Controller 9001]: Broker change listener fired for path /brokers/ids with children 9001,9002
INFO main kafka.log.LogManager - Loading logs.
INFO main kafka.log.LogManager - Logs loading complete.
INFO main kafka.log.LogManager - Starting log cleanup with a period of 300000 ms.
INFO main kafka.log.LogManager - Starting log flusher with a default period of 9223372036854775807 ms.
INFO main kafka.network.Acceptor - Awaiting socket connections on localhost:9003.
INFO main kafka.network.SocketServer - [Socket Server on Broker 9003], Started
INFO main kafka.utils.Mx4jLoader$ - Will not load MX4J, mx4j-tools.jar is not in the classpath
INFO main kafka.controller.KafkaController - [Controller 9003]: Controller starting up
INFO main kafka.controller.KafkaController - [Controller 9003]: Controller startup complete
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.ReplicaStateMachine$BrokerChangeListener - [BrokerChangeListener on Controller 9001]: Newly added brokers: 9002, deleted brokers: , all live brokers: 9001,9002
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.RequestSendThread - [Controller-9001-to-broker-9002-send-thread], Controller 9001 connected to id:9002,host:localhost,port:9002 for sending state change requests
INFO Controller-9001-to-broker-9002-send-thread kafka.controller.RequestSendThread - [Controller-9001-to-broker-9002-send-thread], Starting 
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.KafkaController - [Controller 9001]: New broker startup callback for 9002
INFO main kafka.utils.ZkUtils$ - Registered broker 9003 at path /brokers/ids/9003 with address localhost:9003.
INFO main kafka.server.KafkaServer - [Kafka Server 9003], started
INFO main com.hibigdata.kafka.MiniKafkaCluster - All brokers started
INFO main com.hibigdata.kafka.MiniCluster - Local cluster started.
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.ReplicaStateMachine$BrokerChangeListener - [BrokerChangeListener on Controller 9001]: Broker change listener fired for path /brokers/ids with children 9003,9001,9002
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.ReplicaStateMachine$BrokerChangeListener - [BrokerChangeListener on Controller 9001]: Newly added brokers: 9003, deleted brokers: , all live brokers: 9003,9001,9002
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.RequestSendThread - [Controller-9001-to-broker-9003-send-thread], Controller 9001 connected to id:9003,host:localhost,port:9003 for sending state change requests
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.KafkaController - [Controller 9001]: New broker startup callback for 9003
INFO Controller-9001-to-broker-9003-send-thread kafka.controller.RequestSendThread - [Controller-9001-to-broker-9003-send-thread], Starting 
INFO main com.hibigdata.kafka.MiniCluster - Shuting down local cluster...
INFO main com.hibigdata.kafka.MiniKafkaCluster - Shuting down brokers...
INFO main kafka.server.KafkaServer - [Kafka Server 9001], shutting down
INFO main kafka.server.KafkaServer - [Kafka Server 9001], Starting controlled shutdown
INFO kafka-request-handler-7 kafka.controller.KafkaController - [Controller 9001]: Shutting down broker 9001
INFO main kafka.server.KafkaServer - [Kafka Server 9001], Controlled shutdown succeeded
INFO main kafka.utils.ZkUtils$ - Deregistered broker 9001 at path /brokers/ids/9001.
INFO main kafka.network.SocketServer - [Socket Server on Broker 9001], Shutting down
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.ReplicaStateMachine$BrokerChangeListener - [BrokerChangeListener on Controller 9001]: Broker change listener fired for path /brokers/ids with children 9003,9002
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.ReplicaStateMachine$BrokerChangeListener - [BrokerChangeListener on Controller 9001]: Newly added brokers: , deleted brokers: 9001, all live brokers: 9003,9002
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.RequestSendThread - [Controller-9001-to-broker-9001-send-thread], Shutting down
INFO Controller-9001-to-broker-9001-send-thread kafka.controller.RequestSendThread - [Controller-9001-to-broker-9001-send-thread], Stopped 
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.RequestSendThread - [Controller-9001-to-broker-9001-send-thread], Shutdown completed
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.KafkaController - [Controller 9001]: Broker failure callback for 9001
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.KafkaController - [Controller 9001]: Removed ArrayBuffer(9001) from list of shutting down brokers.
INFO ZkClient-EventThread-16-localhost:2181 kafka.controller.PartitionStateMachine - [Partition state machine on Controller 9001]: Invoking state change to OfflinePartition for partitions 
INFO main kafka.network.SocketServer - [Socket Server on Broker 9001], Shutdown completed
INFO main kafka.server.KafkaRequestHandlerPool - [Kafka Request Handler on Broker 9001], shutting down
INFO main kafka.server.KafkaRequestHandlerPool - [Kafka Request Handler on Broker 9001], shut down completely
INFO main kafka.server.ReplicaManager - [Replica Manager on Broker 9001]: Shut down
INFO main kafka.server.ReplicaFetcherManager - [ReplicaFetcherManager on broker 9001] shutting down
INFO main kafka.server.ReplicaFetcherManager - [ReplicaFetcherManager on broker 9001] shutdown completed
INFO main kafka.server.ReplicaManager - [Replica Manager on Broker 9001]: Shut down completely
INFO main kafka.log.LogManager - Shutting down.
INFO main kafka.log.LogManager - Shutdown complete.
INFO main kafka.controller.PartitionStateMachine - [Partition state machine on Controller 9001]: Stopped partition state machine
INFO main kafka.controller.ReplicaStateMachine - [Replica state machine on controller 9001]: Stopped replica state machine
INFO main kafka.controller.RequestSendThread - [Controller-9001-to-broker-9003-send-thread], Shutting down
INFO Controller-9001-to-broker-9003-send-thread kafka.controller.RequestSendThread - [Controller-9001-to-broker-9003-send-thread], Stopped 
INFO kafka-network-thread-9003-0 kafka.network.Processor - Closing socket connection to /127.0.0.1.
INFO main kafka.controller.RequestSendThread - [Controller-9001-to-broker-9003-send-thread], Shutdown completed
INFO main kafka.controller.RequestSendThread - [Controller-9001-to-broker-9002-send-thread], Shutting down
INFO kafka-network-thread-9002-0 kafka.network.Processor - Closing socket connection to /127.0.0.1.
INFO Controller-9001-to-broker-9002-send-thread kafka.controller.RequestSendThread - [Controller-9001-to-broker-9002-send-thread], Stopped 
INFO main kafka.controller.RequestSendThread - [Controller-9001-to-broker-9002-send-thread], Shutdown completed
INFO ZkClient-EventThread-16-localhost:2181 org.I0Itec.zkclient.ZkEventThread - Terminate ZkClient event thread.
INFO ProcessThread(sid:0 cport:-1): org.apache.zookeeper.server.PrepRequestProcessor - Processed session termination for sessionid: 0x154a916065c0000
INFO main org.apache.zookeeper.ZooKeeper - Session: 0x154a916065c0000 closed
INFO main kafka.server.KafkaServer - [Kafka Server 9001], shut down completed
INFO main kafka.server.KafkaServer - [Kafka Server 9002], shutting down
INFO NIOServerCxn.Factory:localhost/127.0.0.1:2181 org.apache.zookeeper.server.NIOServerCnxn - Closed socket connection for client /127.0.0.1:3368 which had sessionid 0x154a916065c0000
INFO main kafka.server.KafkaServer - [Kafka Server 9002], Starting controlled shutdown
INFO main-EventThread org.apache.zookeeper.ClientCnxn - EventThread shut down
WARN main kafka.utils.Utils$ - Controller doesn't exist
kafka.common.KafkaException: Controller doesn't exist
	at kafka.utils.ZkUtils$.getController(ZkUtils.scala:67)
	at kafka.server.KafkaServer.kafka$server$KafkaServer$$controlledShutdown(KafkaServer.scala:194)
	at kafka.server.KafkaServer$$anonfun$shutdown$1.apply$mcV$sp(KafkaServer.scala:269)
	at kafka.utils.Utils$.swallow(Utils.scala:172)
	at kafka.utils.Logging$class.swallowWarn(Logging.scala:92)
	at kafka.utils.Utils$.swallowWarn(Utils.scala:45)
	at kafka.utils.Logging$class.swallow(Logging.scala:94)
	at kafka.utils.Utils$.swallow(Utils.scala:45)
	at kafka.server.KafkaServer.shutdown(KafkaServer.scala:269)
	at kafka.server.KafkaServerStartable.shutdown(KafkaServerStartable.scala:42)
	at com.hibigdata.kafka.MiniKafkaCluster.shutdown(MiniKafkaCluster.java:69)
	at com.hibigdata.kafka.MiniCluster.shutdown(MiniCluster.java:36)
	at com.hibigdata.kafka.MiniCluster.main(MiniCluster.java:51)
INFO main kafka.utils.ZkUtils$ - Deregistered broker 9002 at path /brokers/ids/9002.
INFO main kafka.network.SocketServer - [Socket Server on Broker 9002], Shutting down
INFO main kafka.network.SocketServer - [Socket Server on Broker 9002], Shutdown completed
INFO ProcessThread(sid:0 cport:-1): org.apache.zookeeper.server.PrepRequestProcessor - Got user-level KeeperException when processing sessionid:0x154a916065c0002 type:create cxid:0x12 zxid:0x1b txntype:-1 reqpath:n/a Error Path:/controller Error:KeeperErrorCode = NodeExists for /controller
INFO main kafka.server.KafkaRequestHandlerPool - [Kafka Request Handler on Broker 9002], shutting down
INFO ZkClient-EventThread-43-localhost:2181 kafka.server.ZookeeperLeaderElector - 9002 successfully elected as leader
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Broker 9002 starting become controller state transition
INFO main kafka.server.KafkaRequestHandlerPool - [Kafka Request Handler on Broker 9002], shut down completely
INFO ZkClient-EventThread-67-localhost:2181 kafka.utils.ZkUtils$ - conflict in /controller data: {"version":1,"brokerid":9003,"timestamp":"1463125680771"} stored data: {"version":1,"brokerid":9002,"timestamp":"1463125680771"}
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Initialized controller epoch to 1 and zk version 0
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Controller 9002 incremented epoch to 2
INFO ZkClient-EventThread-67-localhost:2181 kafka.server.ZookeeperLeaderElector$LeaderChangeListener - New leader is 9002
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.RequestSendThread - [Controller-9002-to-broker-9003-send-thread], Controller 9002 connected to id:9003,host:localhost,port:9003 for sending state change requests
INFO Controller-9002-to-broker-9003-send-thread kafka.controller.RequestSendThread - [Controller-9002-to-broker-9003-send-thread], Starting 
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Partitions undergoing preferred replica election: 
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Partitions that completed preferred replica election: 
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Resuming preferred replica election for partitions: 
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Partitions being reassigned: Map()
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Partitions already reassigned: List()
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Resuming reassignment of partitions: Map()
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: List of topics to be deleted: 
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: List of topics ineligible for deletion: 
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Currently active brokers in the cluster: Set(9003)
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Currently shutting brokers in the cluster: Set()
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Current list of topics in the cluster: Set()
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.ReplicaStateMachine - [Replica state machine on controller 9002]: Started replica state machine with initial state -> Map()
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.PartitionStateMachine - [Partition state machine on Controller 9002]: Started partition state machine with initial state -> Map()
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Broker 9002 is ready to serve as the new controller with epoch 2
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: Starting preferred replica leader election for partitions 
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.PartitionStateMachine - [Partition state machine on Controller 9002]: Invoking state change to OnlinePartition for partitions 
INFO ProcessThread(sid:0 cport:-1): org.apache.zookeeper.server.PrepRequestProcessor - Got user-level KeeperException when processing sessionid:0x154a916065c0001 type:delete cxid:0x24 zxid:0x1d txntype:-1 reqpath:n/a Error Path:/admin/preferred_replica_election Error:KeeperErrorCode = NoNode for /admin/preferred_replica_election
INFO ZkClient-EventThread-43-localhost:2181 kafka.controller.KafkaController - [Controller 9002]: starting the partition rebalance scheduler
INFO ZkClient-EventThread-43-localhost:2181 kafka.server.ZookeeperLeaderElector$LeaderChangeListener - New leader is 9002
INFO main kafka.server.ReplicaManager - [Replica Manager on Broker 9002]: Shut down
INFO main kafka.server.ReplicaFetcherManager - [ReplicaFetcherManager on broker 9002] shutting down
INFO main kafka.server.ReplicaFetcherManager - [ReplicaFetcherManager on broker 9002] shutdown completed
INFO main kafka.server.ReplicaManager - [Replica Manager on Broker 9002]: Shut down completely
INFO main kafka.log.LogManager - Shutting down.
INFO main kafka.log.LogManager - Shutdown complete.
INFO main kafka.controller.PartitionStateMachine - [Partition state machine on Controller 9002]: Stopped partition state machine
INFO main kafka.controller.ReplicaStateMachine - [Replica state machine on controller 9002]: Stopped replica state machine
INFO main kafka.controller.RequestSendThread - [Controller-9002-to-broker-9003-send-thread], Shutting down
INFO kafka-network-thread-9003-1 kafka.network.Processor - Closing socket connection to /127.0.0.1.
INFO Controller-9002-to-broker-9003-send-thread kafka.controller.RequestSendThread - [Controller-9002-to-broker-9003-send-thread], Stopped 
INFO main kafka.controller.RequestSendThread - [Controller-9002-to-broker-9003-send-thread], Shutdown completed
INFO ZkClient-EventThread-43-localhost:2181 org.I0Itec.zkclient.ZkEventThread - Terminate ZkClient event thread.
INFO ProcessThread(sid:0 cport:-1): org.apache.zookeeper.server.PrepRequestProcessor - Processed session termination for sessionid: 0x154a916065c0001
INFO main org.apache.zookeeper.ZooKeeper - Session: 0x154a916065c0001 closed
INFO main kafka.server.KafkaServer - [Kafka Server 9002], shut down completed
INFO main kafka.server.KafkaServer - [Kafka Server 9003], shutting down
INFO main kafka.server.KafkaServer - [Kafka Server 9003], Starting controlled shutdown
INFO main-EventThread org.apache.zookeeper.ClientCnxn - EventThread shut down
WARN NIOServerCxn.Factory:localhost/127.0.0.1:2181 org.apache.zookeeper.server.NIOServerCnxn - caught end of stream exception
EndOfStreamException: Unable to read additional data from client sessionid 0x154a916065c0001, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:228)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
INFO NIOServerCxn.Factory:localhost/127.0.0.1:2181 org.apache.zookeeper.server.NIOServerCnxn - Closed socket connection for client /127.0.0.1:3380 which had sessionid 0x154a916065c0001
WARN main kafka.utils.Utils$ - Controller doesn't exist
kafka.common.KafkaException: Controller doesn't exist
	at kafka.utils.ZkUtils$.getController(ZkUtils.scala:67)
	at kafka.server.KafkaServer.kafka$server$KafkaServer$$controlledShutdown(KafkaServer.scala:194)
	at kafka.server.KafkaServer$$anonfun$shutdown$1.apply$mcV$sp(KafkaServer.scala:269)
	at kafka.utils.Utils$.swallow(Utils.scala:172)
	at kafka.utils.Logging$class.swallowWarn(Logging.scala:92)
	at kafka.utils.Utils$.swallowWarn(Utils.scala:45)
	at kafka.utils.Logging$class.swallow(Logging.scala:94)
	at kafka.utils.Utils$.swallow(Utils.scala:45)
	at kafka.server.KafkaServer.shutdown(KafkaServer.scala:269)
	at kafka.server.KafkaServerStartable.shutdown(KafkaServerStartable.scala:42)
	at com.hibigdata.kafka.MiniKafkaCluster.shutdown(MiniKafkaCluster.java:69)
	at com.hibigdata.kafka.MiniCluster.shutdown(MiniCluster.java:36)
	at com.hibigdata.kafka.MiniCluster.main(MiniCluster.java:51)
INFO main kafka.utils.ZkUtils$ - Deregistered broker 9003 at path /brokers/ids/9003.
INFO main kafka.network.SocketServer - [Socket Server on Broker 9003], Shutting down
INFO main kafka.network.SocketServer - [Socket Server on Broker 9003], Shutdown completed
INFO main kafka.server.KafkaRequestHandlerPool - [Kafka Request Handler on Broker 9003], shutting down
INFO ZkClient-EventThread-67-localhost:2181 kafka.server.ZookeeperLeaderElector - 9003 successfully elected as leader
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Broker 9003 starting become controller state transition
INFO main kafka.server.KafkaRequestHandlerPool - [Kafka Request Handler on Broker 9003], shut down completely
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Initialized controller epoch to 2 and zk version 1
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Controller 9003 incremented epoch to 3
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Partitions undergoing preferred replica election: 
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Partitions that completed preferred replica election: 
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Resuming preferred replica election for partitions: 
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Partitions being reassigned: Map()
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Partitions already reassigned: List()
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Resuming reassignment of partitions: Map()
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: List of topics to be deleted: 
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: List of topics ineligible for deletion: 
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Currently active brokers in the cluster: Set()
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Currently shutting brokers in the cluster: Set()
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Current list of topics in the cluster: Set()
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.ReplicaStateMachine - [Replica state machine on controller 9003]: Started replica state machine with initial state -> Map()
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.PartitionStateMachine - [Partition state machine on Controller 9003]: Started partition state machine with initial state -> Map()
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Broker 9003 is ready to serve as the new controller with epoch 3
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: Starting preferred replica leader election for partitions 
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.PartitionStateMachine - [Partition state machine on Controller 9003]: Invoking state change to OnlinePartition for partitions 
INFO ProcessThread(sid:0 cport:-1): org.apache.zookeeper.server.PrepRequestProcessor - Got user-level KeeperException when processing sessionid:0x154a916065c0002 type:delete cxid:0x2c zxid:0x22 txntype:-1 reqpath:n/a Error Path:/admin/preferred_replica_election Error:KeeperErrorCode = NoNode for /admin/preferred_replica_election
INFO ZkClient-EventThread-67-localhost:2181 kafka.controller.KafkaController - [Controller 9003]: starting the partition rebalance scheduler
INFO ZkClient-EventThread-67-localhost:2181 kafka.server.ZookeeperLeaderElector$LeaderChangeListener - New leader is 9003
INFO main kafka.server.ReplicaManager - [Replica Manager on Broker 9003]: Shut down
INFO main kafka.server.ReplicaFetcherManager - [ReplicaFetcherManager on broker 9003] shutting down
INFO main kafka.server.ReplicaFetcherManager - [ReplicaFetcherManager on broker 9003] shutdown completed
INFO main kafka.server.ReplicaManager - [Replica Manager on Broker 9003]: Shut down completely
INFO main kafka.log.LogManager - Shutting down.
INFO main kafka.log.LogManager - Shutdown complete.
INFO main kafka.controller.PartitionStateMachine - [Partition state machine on Controller 9003]: Stopped partition state machine
INFO main kafka.controller.ReplicaStateMachine - [Replica state machine on controller 9003]: Stopped replica state machine
INFO ZkClient-EventThread-67-localhost:2181 org.I0Itec.zkclient.ZkEventThread - Terminate ZkClient event thread.
INFO ProcessThread(sid:0 cport:-1): org.apache.zookeeper.server.PrepRequestProcessor - Processed session termination for sessionid: 0x154a916065c0002
INFO main org.apache.zookeeper.ZooKeeper - Session: 0x154a916065c0002 closed
INFO NIOServerCxn.Factory:localhost/127.0.0.1:2181 org.apache.zookeeper.server.NIOServerCnxn - Closed socket connection for client /127.0.0.1:3391 which had sessionid 0x154a916065c0002
INFO main-EventThread org.apache.zookeeper.ClientCnxn - EventThread shut down
INFO main kafka.server.KafkaServer - [Kafka Server 9003], shut down completed
ERROR main com.hibigdata.kafka.MiniKafkaCluster - Could not delete base directory: D:\dev\git\kafka-storm\target\cluster
ERROR main org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[main,5,main] died
java.lang.RuntimeException: java.io.IOException: Unable to delete file: target\cluster\snapshots\version-2\log.1
	at com.hibigdata.kafka.MiniKafkaCluster.shutdown(MiniKafkaCluster.java:75)
	at com.hibigdata.kafka.MiniCluster.shutdown(MiniCluster.java:36)
	at com.hibigdata.kafka.MiniCluster.main(MiniCluster.java:51)
Caused by: java.io.IOException: Unable to delete file: target\cluster\snapshots\version-2\log.1
	at org.apache.commons.io.FileUtils.forceDelete(FileUtils.java:1247)
	at org.apache.commons.io.FileUtils.cleanDirectory(FileUtils.java:903)
	at org.apache.commons.io.FileUtils.deleteDirectory(FileUtils.java:869)
	at org.apache.commons.io.FileUtils.forceDelete(FileUtils.java:1239)
	at org.apache.commons.io.FileUtils.cleanDirectory(FileUtils.java:903)
	at org.apache.commons.io.FileUtils.deleteDirectory(FileUtils.java:869)
	at org.apache.commons.io.FileUtils.forceDelete(FileUtils.java:1239)
	at org.apache.commons.io.FileUtils.cleanDirectory(FileUtils.java:903)
	at org.apache.commons.io.FileUtils.deleteDirectory(FileUtils.java:869)
	at com.hibigdata.kafka.MiniKafkaCluster.shutdown(MiniKafkaCluster.java:72)
	... 2 more
